(self["webpackChunksurveyor_front"]=self["webpackChunksurveyor_front"]||[]).push([[706],{5109:function(e,t,s){"use strict";var r=s(3316),n=s(4905);const{t:o,te:a}=n["default"].global;class i{constructor(){(0,r.Z)(this,"errors",{}),(0,r.Z)(this,"status",null),(0,r.Z)(this,"message","")}has(e){for(const t in this.errors)if(t===e)return!0;return!1}any(){return null!==this.errors&&void 0!==this.errors&&Object.keys(this.errors).length>0}get(e){return this.errors[e]?this.errors[e][0]:null}record(e){this.status=e.response.status??null,this.errors=void 0!==e.response.data.errors?e.response.data.errors:{},this.message=void 0!==e.response.data.message?e.response.data.message:""}clear(e=null){if(e)return delete this.errors[e],void(this.errors.length||(this.status=null,this.message=""));this.errors={},this.status=null,this.message=""}getMessage(){return null!==this.status&&a("response.errors."+this.status)?o("response.errors."+this.status):this.message}}t.Z=i},7084:function(e,t,s){"use strict";s.d(t,{Z:function(){return f}});var r=s(3316),n=(s(1379),s(6216)),o=s(4905),a=s(4850),i=s(5109),l=s(8805);const u=1500;var d=s(7342),c=s(9756);const{t:p}=o["default"].global;class m{constructor(e=null){(0,r.Z)(this,"errors",new i.Z),(0,r.Z)(this,"model",null),(0,r.Z)(this,"submittable",!0),(0,r.Z)(this,"defaultOptions",{showSuccessToast:!0,showFailToast:!0}),this.model=e}bind(e){this.model=e}getData(){const e=this.model?.getData();return this.hasFile(this.model)?(0,d.serialize)(e,{indices:!0,booleansAsIntegers:!0}):e}hasFile(e){for(const t in e){if(e[t]instanceof File||e[t]instanceof Blob)return!0;if(("object"===typeof e[t]&&null!==e[t]||(0,c.isArray)(e[t]))&&this.hasFile(e[t]))return!0}return!1}submit(e,t,s){this.beforeSubmit();const r=this.model,o=this.getData();return new Promise(((i,d)=>{n.Z[e](t,o).then((e=>{if(s.showSuccessToast&&a.Z.fire(p(`response.success.${s.action}`),"success"),"undefined"!==typeof s.action&&["store","update"].includes(s.action)&&r.saveAttributes(e.data),"undefined"!==typeof s.redirect){const e=s.redirect;s.idForRedirect&&this.model&&(e.params={id:this.model.id}),setTimeout((()=>{l.Z.push(e)}),u)}return i(e)})).catch((e=>(this.errors.record(e),s.showFailToast&&a.Z.fire(this.errors.getMessage(),"error"),d(e)))).finally((()=>{this.afterSubmit()}))}))}beforeSubmit(){this.submittable=!1}afterSubmit(){this.submittable=!0}store(e={}){const t=this.model;return e={...this.defaultOptions,action:"store",...e},this.submit("post",`${t.getMainRoute()}/store`,e)}update(e={}){const t=this.model;return e={...this.defaultOptions,action:"update",...e},this.submit("post",`${t.getMainRoute()}/update/${t.id}`,e)}delete(e={}){const t=this.model;return e={...this.defaultOptions,action:"delete",...e},this.submit("delete",`${t.getMainRoute()}/delete/${t.id}`,e)}}var f=m},7342:function(e){function t(e){return void 0===e}function s(e){return null===e}function r(e){return"boolean"===typeof e}function n(e){return e===Object(e)}function o(e){return Array.isArray(e)}function a(e){return e instanceof Date}function i(e,s){return s?n(e)&&!t(e.uri):n(e)&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.slice}function l(e,t){return i(e,t)&&"string"===typeof e.name&&(n(e.lastModifiedDate)||"number"===typeof e.lastModified)}function u(e){return!t(e)&&e}function d(e,c,p,m){c=c||{},p=p||new FormData,c.indices=u(c.indices),c.nullsAsUndefineds=u(c.nullsAsUndefineds),c.booleansAsIntegers=u(c.booleansAsIntegers),c.allowEmptyArrays=u(c.allowEmptyArrays),c.noAttributesWithArrayNotation=u(c.noAttributesWithArrayNotation),c.noFilesWithArrayNotation=u(c.noFilesWithArrayNotation),c.dotsForObjectNotation=u(c.dotsForObjectNotation);const f="function"===typeof p.getParts;return t(e)||(s(e)?c.nullsAsUndefineds||p.append(m,""):r(e)?c.booleansAsIntegers?p.append(m,e?1:0):p.append(m,e):o(e)?e.length?e.forEach(((e,t)=>{let s=m+"["+(c.indices?t:"")+"]";(c.noAttributesWithArrayNotation||c.noFilesWithArrayNotation&&l(e,f))&&(s=m),d(e,c,p,s)})):c.allowEmptyArrays&&p.append(c.noAttributesWithArrayNotation?m:m+"[]",""):a(e)?p.append(m,e.toISOString()):n(e)&&!i(e,f)?Object.keys(e).forEach((t=>{const s=e[t];if(o(s))while(t.length>2&&t.lastIndexOf("[]")===t.length-2)t=t.substring(0,t.length-2);const r=m?c.dotsForObjectNotation?m+"."+t:m+"["+t+"]":t;d(s,c,p,r)})):p.append(m,e)),p}e.exports={serialize:d}},8706:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return M}});var r=s(3723),n=s(4719),o=s(4386);const a={class:"p-4 card xl:p-5"},i={class:"space-y-4"},l={class:"text-xl font-semibold"},u={class:"sticky flex gap-x-4 bg-white py-4 top-[61px] z-1"},d=(0,r._)("div",{class:"w-10 self-center"},"#",-1),c={class:"flex-1 font-medium"},p={class:"flex-1 font-medium"},m={class:"flex-1 font-medium"},f=(0,r._)("div",{class:"w-10"},null,-1),h={class:"w-10 self-center font-medium"},b={class:"flex-1"},y=["onUpdate:modelValue","name","id"],v={class:"flex-1"},g={class:"flex-1"},w=["name","id","min","value","onInput","disabled"],_={class:"w-10 self-center"},A=(0,r._)("i",{class:"fa fa-lg fa-times"},null,-1),k={class:"mr-2"},x=(0,r._)("i",{class:"fa fa-lg fa-plus"},null,-1),$={class:"text-end space-x-3"};function S(e,t,s,S,Z,F){const N=(0,r.up)("breadcrumb-list"),O=(0,r.up)("vue-select"),W=(0,r.up)("v-button");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(N,{items:Z.breadcrumbs},null,8,["items"]),(0,r._)("div",a,[(0,r._)("form",{onInput:t[1]||(t[1]=e=>Z.request.errors.clear(e.target.name)),onSubmit:t[2]||(t[2]=(0,n.iM)((e=>F.submit()),["prevent"]))},[(0,r._)("div",i,[(0,r._)("div",null,[(0,r._)("h3",l,(0,o.zw)(e.$t("labels.group_surveys_title",{workspace:Z.group.workspace_name,group:Z.group.name})),1)]),(0,r._)("div",u,[d,(0,r._)("div",c,(0,o.zw)(e.$t("attributes.survey")),1),(0,r._)("div",p,(0,o.zw)(e.$t("attributes.template")),1),(0,r._)("div",m,(0,o.zw)(e.$t("attributes.survey_at")),1),f]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(Z.group.surveys,((t,s)=>((0,r.wg)(),(0,r.iD)("div",{key:s,class:"flex gap-x-4"},[(0,r._)("div",h,(0,o.zw)(s+1)+".",1),(0,r._)("div",b,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":e=>t.name=e,name:`survey${s}Name`,id:`textSurvey${s}Name`,type:"text",autocomplete:"off",class:"h-10 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 form-input peer hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"},null,8,y),[[n.nr,t.name]])]),(0,r._)("div",v,[(0,r.Wm)(O,{options:Z.templates.get(),label:"name",reduce:e=>e.id,modelValue:t.template_id,"onUpdate:modelValue":e=>t.template_id=e,name:`survey${s}TemplateId`},null,8,["options","reduce","modelValue","onUpdate:modelValue","name"])]),(0,r._)("div",g,[(0,r._)("input",{name:`survey${s}SurveyAt`,id:`dateSurvey${s}SurveyAt`,min:F.moment().add(1,"day").format("YYYY-MM-DD"),value:t.surveyAtISO,type:"date",class:"h-10 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 form-input peer hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent",onInput:e=>t.survey_at=F.moment(e.target.value),disabled:!t.isEditable},null,40,w)]),(0,r._)("div",_,[(0,r.Wm)(W,{color:"transparent",icon:"",title:e.$t("labels.delete"),onClick:e=>Z.group.removeSurvey(s)},{default:(0,r.w5)((()=>[A])),_:2},1032,["title","onClick"])])])))),128)),(0,r._)("div",null,[(0,r.Wm)(W,{color:"transparent",block:"",weight:"normal",align:"end",onClick:t[0]||(t[0]=e=>Z.group.addSurvey())},{default:(0,r.w5)((()=>[(0,r._)("span",k,(0,o.zw)(e.$t("labels.add_survey")),1),x])),_:1})]),(0,r._)("div",$,[(0,r.Wm)(W,{type:"submit",color:"primary",disabled:!Z.request.submittable},{default:(0,r.w5)((()=>[(0,r.Uk)((0,o.zw)(e.$t("labels.submit")),1)])),_:1},8,["disabled"])])])],32)])],64)}var Z=s(9981),F=s(7084),N=s(4930),O=s(2579),W=s.n(O),z={name:"GroupSurveys",computed:{moment(){return W()}},props:{id:{type:[Number,String],required:!1}},data(){return{breadcrumbs:[{title:this.$t("titles.workspaces"),route:"app.workspaces"},{title:this.$t("titles.group")},{title:this.$t("titles.surveys"),active:!0}],templates:new N["default"],group:new Z.Z,request:new F.Z}},created(){this.templates.fetchAll(),this.group.fetch(this.id),this.request.bind(this.group)},methods:{submit(){this.request.update({redirect:{name:"app.workspaces"}})}}},D=s(8380);const I=(0,D.Z)(z,[["render",S]]);var M=I}}]);
//# sourceMappingURL=706.bcfaf7c3.js.map